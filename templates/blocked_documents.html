{% extends "base.html" %}

{% block title %}Blocked Documents - P2P Workflow{% endblock %}

{% block content %}
<h1>Blocked Documents</h1>

{% if blocked.purchase_orders %}
<div class="card">
    <div class="card-header">Blocked Purchase Orders</div>
    <table class="table">
        <thead>
            <tr>
                <th>PO Number</th>
                <th>Requester</th>
                <th>Vendor</th>
                <th>Amount</th>
                <th>Blocked Reason</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for po in blocked.purchase_orders %}
            <tr>
                <td><strong>{{ po.po_number }}</strong></td>
                <td>{{ po.requester }} ({{ po.department }})</td>
                <td>{{ po.vendor_name }}</td>
                <td>{{ po.total_amount | format_currency }}</td>
                <td style="color: #dc3545;">{{ po.blocked_reason }}</td>
                <td><a href="{{ url_for('purchase_order_detail', po_id=po.id) }}" class="btn btn-primary">View</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

{% if blocked.goods_receipts %}
<div class="card">
    <div class="card-header">Blocked Goods Receipts</div>
    <table class="table">
        <thead>
            <tr>
                <th>GR Number</th>
                <th>Related PO</th>
                <th>Received By</th>
                <th>Blocked Reason</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for gr in blocked.goods_receipts %}
            <tr>
                <td><strong>{{ gr.gr_number }}</strong></td>
                <td>{{ gr.po_number }}</td>
                <td>{{ gr.received_by }}</td>
                <td style="color: #dc3545;">{{ gr.blocked_reason }}</td>
                <td><a href="{{ url_for('goods_receipt_detail', gr_id=gr.id) }}" class="btn btn-primary">View</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

{% if blocked.invoices %}
<div class="card">
    <div class="card-header">Blocked Invoices</div>
    <table class="table">
        <thead>
            <tr>
                <th>Invoice Number</th>
                <th>Vendor</th>
                <th>Related PO</th>
                <th>Amount</th>
                <th>Blocked Reason</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for inv in blocked.invoices %}
            <tr>
                <td><strong>{{ inv.invoice_number }}</strong></td>
                <td>{{ inv.vendor_name }}</td>
                <td>{{ inv.po_number }}</td>
                <td>{{ inv.total_amount | format_currency }}</td>
                <td style="color: #dc3545;">{{ inv.blocked_reason }}</td>
                <td><a href="{{ url_for('invoice_detail', invoice_id=inv.id) }}" class="btn btn-primary">View</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

{% if not blocked.purchase_orders and not blocked.goods_receipts and not blocked.invoices %}
<div class="card">
    <div class="empty-state">
        <div class="empty-state-icon">âœ…</div>
        <p>No blocked documents. All systems operational!</p>
    </div>
</div>
{% endif %}
{% endblock %}
